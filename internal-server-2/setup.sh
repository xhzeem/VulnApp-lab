#!/bin/bash

# Generate SSH key for root if it doesn't exist
if [ ! -f /root/.ssh/id_rsa ]; then
    mkdir -p /root/.ssh
    
    # Create a specific SSH key that matches the one in the web app HTML comment
    cat > /root/.ssh/id_rsa << 'EOF'
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAyFqVN8kL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzEr
TnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sP
kL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT
7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7
RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP
9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzEr
TnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sP
kL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT
7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPAgMBAAECggEAQxR4tN6sP
9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzEr
TnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sP
kL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT
7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7
RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP
9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzEr
TnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sP
kL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT
7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7
RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP
9wX5kL7vM3nQ9xY2tR8sPQKBgQDxY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3l
Km4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7
vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4
kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPQKBgQDT
nM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPk
L3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7
mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7R
tYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9
wX5kL7vM3nQ9xY2tR8sPQKBgQCxR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5Jx
PZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9v
H2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lK
m4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7v
M3nQ9xY2tR8sPQKBgQCkJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM
3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ
9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5JxP
Z8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH
2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPQKBgQDH5JxPZ8mKj9wX2nQ7RtYuP3l
Km4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7
vM3nQ9xY2tR8sPkL3vH5JxPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4
kJ9vR6sX8wY3nT7mP5kL9vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sPkL3vH5J
xPZ8mKj9wX2nQ7RtYuP3lKm4vN8sW9xQzErTnM2pL4kJ9vR6sX8wY3nT7mP5kL9
vH2jQ8xR4tN6sP9wX5kL7vM3nQ9xY2tR8sP
-----END RSA PRIVATE KEY-----
EOF
    
    chmod 600 /root/.ssh/id_rsa
    ssh-keygen -y -f /root/.ssh/id_rsa > /root/.ssh/id_rsa.pub
    cat /root/.ssh/id_rsa.pub >> /root/.ssh/authorized_keys
    chmod 600 /root/.ssh/authorized_keys
    chmod 700 /root/.ssh
    
    echo "FLAG{ssh_key_from_html_comment}" > /root/flag.txt
fi
